
<%- include('partials/header.ejs'); %>

	<main class="container">
		<div class="bg-light p-3 rounded">
			<% if ( user.name ) { %>
				<h1>Welcome to the RSC Development League, <%= user.name %></h1>
			<% } else { %>
				<h1>Welcome to the RSC Development League</h1>
			<% } %>
			<div class="row">
				<div class="col-md-8">

					<p class="lead">
						The RSC Development League is a Rocket League competitive league that runs concurrently to the 
						active RSC season. It is open to all Free Agents and Permanent Free Agents as a way to showcase 
						your talent and generate player statistics. 
					</p>

					<h3>Dev League Info</h3>
					<p>
						Players currently rostered inside of RSC Franchises are also <strong>strongly</strong>
						encouraged to sign up and play as a sub so that we can ensure we have enough players in each tier
						to have at least two teams playing every night. Free agents will always receive priority in being placed 
						on a team, but anyone that signs up as a sub will be used on a first-come, first-served basis as needed
						to fill out teams.
					</p>
					<p>
						Games run every Monday and Wednesday night on active game days at <strong>8:15PM ET</strong> and are usually finished before 9:00PM
						so that you can sub for active franchises if needed. If you wish to play tonight, please check in by clicking
						the button below (must be signed in with your Discord account). 
					</p>
					<p>
						<strong>Be aware...</strong> the RSC Development League is for FAs. Players checking in and then choosing at
						the last minute not to play hurt our ability to provide this service. Only check in if you're 100% committed to 
						playing a series of 4 games at 8:15PM. 
					</p>
				</div>
				<div class="col-md-4">
					<h3>Season <%= settings.season %> Dates</h3>
					<ul>
						<%
							for ( let match_date in match_days ) {
						%>
						<li><%- match_date %> - <%- match_days[ match_date ] == 'holiday' ? '<strong>Holiday - No Games</strong>' : match_days[match_date] %></li>
						<%
							}
						%>
					</ul>
				</div>
			</div>
		</div>

		<div class="bg-light p-3 rounded">
		<% if ( match_day && match_day != 'holiday' ) { %>

			<% if ( nickname && ! checked_in && "rsc_id" in user && user['rsc_id'] != null && settings[ user.tier.toLowerCase() ] != 0 ) { %>

			<!-- check in features -->	
			<style type="text/css">
				dialog#confirmCheckIn {
					background-color: #C2FFD7;
					border-radius: 12px;
					max-width: 50vw;
				}

				dialog#confirmCheckIn::backdrop {
					background-color:  #FF3400aa;
				}
			</style>

			<dialog id="confirmCheckIn">
				<h4>Confirm Check In</h4>
				<p>
					<strong>Warning!</strong> - Dev League is a privilege. Only check in if you are committed to being
					present in the discord at 8PM ET and actively want to participate. Not showing up when you've checked in
					hurts our ability to provide this service for all other players. 
				</p>
				<h5>IF YOU CHECK IN AND ARE NOT PRESENT AT GAME TIME, YOU WILL BE <u>BANNED</u> FROM DEV LEAGUE!</h5>
				<a class="btn btn-lg btn-primary" href="/check_in/<%= match_day %>" role="button">Confirm Check In!</a>
				<a class="btn btn-lg btn-danger" id="backOut" href="javascript:void(0);" role="button" style="float:right;">Cancel</a>
			</dialog>

			<a class="btn btn-lg btn-primary" href="javascript:void(0);" role="button" id="checkInModal">Check In!</a>

			<script type="text/javascript">
				document.getElementById('checkInModal').addEventListener('click', function() {
					document.getElementById('confirmCheckIn').showModal();
				});

				document.getElementById('backOut').addEventListener('click', function() {
					document.getElementById('confirmCheckIn').close();
				});
			</script>


			<% } else if ( nickname && checked_in && rostered && "rsc_id" in user && user['rsc_id'] != null ) { %>
				<h2>Your Team is Ready to Play!</h2>
				<p class="lead">
					You have been selected to play tonight. Click the "Match" link in the sidebar or click the button below. 
				</p>
				<a class="btn btn-lg btn-success" href="/match" role="button">View Match Details</a>
			<% } else if ( nickname && checked_in && "rsc_id" in user && user['rsc_id'] != null ) { %>
			<h2>You are checked in!</h2>
			<p class="lead">
				Rosters are generated around 8:00PM. Keep an eye on the channel <a href="https://discord.com/channels/395806681994493964/1013519443684511834">#dev-league</a> channel for updates.	
				If you are unable to play, you may check out using the check out button below. 
				<strong>At 8:00PM, your match information will be available at THIS website.</strong>
			</p>
			<a class="btn btn-lg btn-danger" href="/check_out/<%= match_day %>" role="button">Check Out</a>
			<% } else if ( nickname && user['rsc_id'] == null ) { %>
			<h2>You are not an active player</h2>
			<p>
				This league is only available to valid members of RSC with an active contract. Please sign up for the league
				at <a href="https://discord.gg/rsc" rel="nofollow">https://discord.gg/rsc</a>
			</p>
			<% } else if ( nickname &&  "rsc_id" in user && user['rsc_id'] != null && settings[ user.tier.toLowerCase() ] == 0) { %>
			<h2>Your tier is not available in the RSC Development League</h2>
			<p>
				Your tier, <%= user.tier %>, is not currently enabled for the RSC Development League. Check back next season or ask about it in 
				Discord.
			</p>
			<% } else { %>
			<a class="btn btn-lg btn-primary" href="https://discord.com/api/oauth2/authorize?client_id=1006600605265055876&redirect_uri=https%3A%2F%2Frsc-devleague.herokuapp.com%2Foauth2&response_type=token&scope=identify" role="button">Log In with Discord</a>
			<% } %>

		<% } else if ( match_day && match_day == 'holiday' ) { %>
			
			<h2>Happy Holidays üéÜ from RSC!</h2>
			<p>
				Today is a Holiday RSC is taking a much-needed vacation. Please enjoy time with your loved ones. ‚ù§Ô∏è
			</p>

		<% } else { %>

			<h2>It is not an RSC Match Day</h2>
			<p>
				Games are played on official RSC Match Days (Mondays/Wednesdays). Come back later!
			</p>

		<% } %>
			
		
		</div>
	</main>

<%- include('partials/footer.ejs'); %>