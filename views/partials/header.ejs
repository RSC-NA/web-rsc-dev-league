<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<meta name="description" content="RSC Development League is an additional league open to all active players in RSC." />
		<meta name="author" content="RSC Development Committee" />
		<title><%= title %></title>
		<link href="/css/styles.css" rel="stylesheet" />
		<script src="https://use.fontawesome.com/releases/v6.4.0/js/all.js" crossorigin="anonymous"></script>
		<script type="text/javascript" src="https://cdn.rawgit.com/jmhobbs/Konami-Unicorn-Blitz/master/konami-unicorn-blitz.min.js"></script>
		<script type="text/javascript" src="/js/timeago.js"></script>
		<script type="text/javascript" src="/js/devleague.js"></script>
		<link href="/css/devleague.css" rel="stylesheet" />

		<meta property="og:locale" content="en_US" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="<%= title %>" />
		<meta property="og:description" content="<%= description %>" />
		<meta property="og:url" content="https://devleague.rscstream.com/" />
		<meta property="og:site_name" content="RSC Development League" />
		<link rel="icon" type="image/x-icon" href="/images/rscpride-192.png" sizes="192x192" />
		<link rel="apple-touch-icon" href="/images/cropped-rsc-logo-1000-180x180.png" />
		<meta name="msapplication-TileImage" content="/images/rscpride-192.png" />
	</head>
	<body class="sb-nav-fixed">
		<nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
			<!-- Navbar Brand-->
			<a class="navbar-brand ps-3" href="/">
				<img src="/images/rscpride-192.png" style="float:left;margin-top:12px;height:42px;" alt="RSC Logo">
				<div>Rocket Soccar</div><div>Confederation</div> 
			</a>
			<!-- Sidebar Toggle-->
			<button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
			<!-- Navbar Search-->
			<!-- Navbar-->
			<ul class="navbar-nav d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0 sb-sidenav-menu">
				<li class="nav-item dropdown">
					<% if ( discord_id) { %>
					<a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span><%= nickname %></span></a>
					<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
							<!-- <li><a class="dropdown-item" href="/player/<%= discord_id %>">View Profile</a></li> -->
							<li><a class="dropdown-item" href="/logout">Log Out</a></li>
						<% } else { %>
					<a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span>Login</span></a>
					<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
						<li><a class="dropdown-item" href="/login_with_discord">Login w/ Discord</a></li>
						<% } %>
					</ul>
				</li>
			</ul>
		</nav>
		<div id="layoutSidenav">
			<div id="layoutSidenav_nav">
				<nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
					<div class="sb-sidenav-menu">
						<div class="nav">
							<div class="sb-sidenav-menu-heading">Core</div>
							<a class="nav-link <%- menu['dashboard'] %>" href="/">
								<div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
								Dashboard
							</a>
							<a class="nav-link <%- menu['championship'] %>" href="/championship">
								<div class="sb-nav-link-icon"><i class="fas fa-trophy"></i></div>
								S<%= settings.season; %> Championship
							</a>
							<a class="nav-link <%- menu['tracker'] %>" href="/tracker">
								<div class="sb-nav-link-icon"><i class="fas fa-award"></i></div>
								Tracker Leaderboard
							</a>

						<% if ( rostered ) { %>
							<a class="nav-link <%- menu['match'] %>" href="/match">
								<div class="sb-nav-link-icon"><i class="fas fa-gamepad"></i></div>
								Match Info
							</a>
						<% } %>

						<%
							//console.log('Future Tournaments:', future_tournaments);
							//console.log('My Tournaments:', my_tournaments);
							if ( future_tournaments.total ) {
						%>
							<div class="sb-sidenav-menu-heading">Tournaments</div>
							<a class="nav-link <%- menu['tournaments'] %>" href="/match">
								<div class="sb-nav-link-icon"><i class="fas fa-trophy"></i></div>
								Tournaments
							</a>
						<%
								if ( Object.keys(my_tournaments).length ) {
									for ( const t_id in my_tournaments ) { 
										const tourney = my_tournaments[t_id];
										const team_name = tourney.team_id ? tourney.team.name : '';
						%>
							<a class="nav-link <%- menu['tournament'] %>" href="/tournament/<%- tourney.t_id; %>">
								<div class="sb-nav-link-icon"><i class="fas fa-trophy"></i></div>
								<%= tourney.title; %>		
							</a>
							
						<% 
									}
								}
							}

							if ( is_admin || is_stats_admin || is_devleague_admin) {  /* admin-only functionality */ 
								let badge_class = 'bg-secondary';
								let pending_count = 0;
								if ( pending_trackers ) {
									pending_count = pending_trackers;
									badge_class = 'bg-danger';
								}
								let bad_badge_class = 'bg-secondary';
								let bad_pending_count = 0;
								if ( bad_pending_trackers ) {
									bad_pending_count = bad_pending_trackers;
									bad_badge_class = 'bg-danger';
								}
						%>
							<div class="sb-sidenav-menu-heading">Admin</div>

						<%

								if ( is_admin || is_devleague_admin ) {
						%>

							<a class="nav-link <%- menu['process_gameday'] %>" href="/process_gameday">
								<div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
								Process Gameday
							</a>
							<a class="nav-link <%- menu['matches'] %>" href="/matches">
								<div class="sb-nav-link-icon"><i class="fas fa-list-ol"></i></div>
								View Matches
							</a>
							<a class="nav-link <%- menu['manage_league'] %>" href="/manage_league">
								<div class="sb-nav-link-icon"><i class="fas fa-table"></i></div>
								Manage League
							</a>
						<% 
								}

								if ( is_admin || is_stats_admin ) {
						%>
							<div class="sb-sidenav-menu-heading">Trackers</div>
							<a class="nav-link" href="/bump_api">
								<div class="sb-nav-link-icon"><i class="fas fa-power-off"></i></div>
								Toggle API
								<% if ( ! SEND_TO_API_SERVER ) { %>
								<span class="badge ms-2 bg-danger">off</span>
								<% } %>
							</a>
							<%
									if ( pending_count || bad_pending_count ) {
							%>
							<hr>
							<%
									}
						
									if ( pending_count ) {
							%>
							<a class="nav-link" href="/send_tracker_data">
								<div class="sb-nav-link-icon"><i class="fas fa-table"></i></div>
								Store Trackers
								<span class="badge ms-2 <%- badge_class %>"><%- pending_count %></span>
							</a>
							<%
									}
							
									if ( pending_count ) {
							%>
							<a class="nav-link" href="/send_bad_trackers">
								<div class="sb-nav-link-icon"><i class="fas fa-triangle-exclamation"></i></div>
								Store Bad
								<span class="badge ms-2 <%- bad_badge_class %>"><%- bad_pending_count %></span>
							</a>
							<%
									}
							%>
							<div class="sb-sidenav-menu-heading">Slow Actions</div>
							<a class="nav-link" href="#" id="run3sStats">
								<div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
								Update 3s Stats
							</a>
							<a class="nav-link" href="#" id="run2sStats">
								<div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
								Update 2s Stats
							</a>
							<a class="nav-link" href="/import_trackers">
								<div class="sb-nav-link-icon"><i class="fas fa-table"></i></div>
								Import Trackers
							</a>
							<dialog id="run3sModal">
								<h3>Are you sure you want to run 3s stats? This takes a while.</h3>
								<a href="/pull_stats" class="btn btn-primary">Confirm!</a>
								<a href="/" class="btn btn-warning">Cancel</a>
							</dialog>
							<dialog id="run2sModal">
								<h3>Are you sure you want to run 2s stats? This takes a while.</h3>
								<a href="/pull_stats_2" class="btn btn-primary">Confirm!</a>
								<a href="/" class="btn btn-warning">Cancel</a>
							</dialog>
							<script type="text/javascript">
								document.getElementById('run3sStats').addEventListener('click', (ev) => {
									ev.preventDefault;
									document.getElementById('run3sModal').showModal();
								});
								document.getElementById('run2sStats').addEventListener('click', (ev) => {
									ev.preventDefault;
									document.getElementById('run2sModal').showModal();
								});
							</script>
						<% 
								}
							}
						%>

						</div>
					</div>
				</nav>
			</div>
			<div id="layoutSidenav_content">

